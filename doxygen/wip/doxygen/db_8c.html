<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libseccomp: src/db.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libseccomp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">db.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;<a class="el" href="seccomp_8h_source.html">seccomp.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="arch_8h_source.html">arch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="db_8h_source.html">db.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system_8h_source.html">system.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="helper_8h_source.html">helper.h</a>&quot;</code><br />
</div>
<p><a href="db_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdb__iter__state.html">db_iter_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a98728e9da07433fdf1874b0b13601ff2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a98728e9da07433fdf1874b0b13601ff2">_DB_STA_VALID</a>&#160;&#160;&#160;0xA1B2C3D4</td></tr>
<tr class="separator:a98728e9da07433fdf1874b0b13601ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13bdcb595412250ba2b9ef802372dc3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a13bdcb595412250ba2b9ef802372dc3b">_DB_STA_FREED</a>&#160;&#160;&#160;0x1A2B3C4D</td></tr>
<tr class="separator:a13bdcb595412250ba2b9ef802372dc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421d4e235d561538df77ba2151748032"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a421d4e235d561538df77ba2151748032">_DB_PRI_MASK_CHAIN</a>&#160;&#160;&#160;0x0000FFFF</td></tr>
<tr class="separator:a421d4e235d561538df77ba2151748032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae85d0cd768a0726fac83cadead8c41"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a9ae85d0cd768a0726fac83cadead8c41">_DB_PRI_MASK_USER</a>&#160;&#160;&#160;0x00FF0000</td></tr>
<tr class="separator:a9ae85d0cd768a0726fac83cadead8c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe866f96ce15729601dc44ffcaa93f08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#abe866f96ce15729601dc44ffcaa93f08">_DB_PRI_USER</a>(x)&#160;&#160;&#160;(((x) &lt;&lt; 16) &amp; <a class="el" href="db_8c.html#a9ae85d0cd768a0726fac83cadead8c41">_DB_PRI_MASK_USER</a>)</td></tr>
<tr class="separator:abe866f96ce15729601dc44ffcaa93f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38945a7d0dc364f60618d25f57392671"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a38945a7d0dc364f60618d25f57392671">_DB_IST_NONE</a>&#160;&#160;&#160;0x00000000</td></tr>
<tr class="separator:a38945a7d0dc364f60618d25f57392671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1822b35342fb6811a2461c5b764cb82e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a1822b35342fb6811a2461c5b764cb82e">_DB_IST_MATCH</a>&#160;&#160;&#160;0x00000001</td></tr>
<tr class="separator:a1822b35342fb6811a2461c5b764cb82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9095bc2f711e3cea2dd0009234b2f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a0e9095bc2f711e3cea2dd0009234b2f5">_DB_IST_MATCH_ONCE</a>&#160;&#160;&#160;0x00000002</td></tr>
<tr class="separator:a0e9095bc2f711e3cea2dd0009234b2f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae043100fef5f7300a64f9a27c8458b54"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#ae043100fef5f7300a64f9a27c8458b54">_DB_IST_X_FINISHED</a>&#160;&#160;&#160;0x00000010</td></tr>
<tr class="separator:ae043100fef5f7300a64f9a27c8458b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa5151c1608cd88ac5438a862da0a63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#acfa5151c1608cd88ac5438a862da0a63">_DB_IST_N_FINISHED</a>&#160;&#160;&#160;0x00000020</td></tr>
<tr class="separator:acfa5151c1608cd88ac5438a862da0a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7283197f8fca88fca16d274ba18b675"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#ac7283197f8fca88fca16d274ba18b675">_DB_IST_X_PREFIX</a>&#160;&#160;&#160;0x00000100</td></tr>
<tr class="separator:ac7283197f8fca88fca16d274ba18b675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae97fc2b3f8442d2f3c5bb29c0415ce5f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#ae97fc2b3f8442d2f3c5bb29c0415ce5f">_DB_IST_N_PREFIX</a>&#160;&#160;&#160;0x00000200</td></tr>
<tr class="separator:ae97fc2b3f8442d2f3c5bb29c0415ce5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a090399e38d155994d96ce07ef3527c3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a090399e38d155994d96ce07ef3527c3e">_DB_IST_M_MATCHSET</a>&#160;&#160;&#160;(<a class="el" href="db_8c.html#a1822b35342fb6811a2461c5b764cb82e">_DB_IST_MATCH</a>|<a class="el" href="db_8c.html#a0e9095bc2f711e3cea2dd0009234b2f5">_DB_IST_MATCH_ONCE</a>)</td></tr>
<tr class="separator:a090399e38d155994d96ce07ef3527c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf706efac6834cdbcc4f3bc2f08a0bd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#acf706efac6834cdbcc4f3bc2f08a0bd0">_DB_IST_M_REDUNDANT</a></td></tr>
<tr class="separator:acf706efac6834cdbcc4f3bc2f08a0bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a718c80b8eadb17f68928b99a1628192b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a718c80b8eadb17f68928b99a1628192b">db_rule_dup</a> (const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *src)</td></tr>
<tr class="separator:a718c80b8eadb17f68928b99a1628192b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88ba803a28b8aeb6cf4dc07906129736"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a88ba803a28b8aeb6cf4dc07906129736">db_col_reset</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, uint32_t def_action)</td></tr>
<tr class="separator:a88ba803a28b8aeb6cf4dc07906129736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce7caff59161c658d06d61d63034ee1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#afce7caff59161c658d06d61d63034ee1">db_col_init</a> (uint32_t def_action)</td></tr>
<tr class="separator:afce7caff59161c658d06d61d63034ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93ca148cd3ffebba2016403551bf2d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#ac93ca148cd3ffebba2016403551bf2d2">db_col_release</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col)</td></tr>
<tr class="separator:ac93ca148cd3ffebba2016403551bf2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ba6deeca3e459a0f188e000b00df34b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a1ba6deeca3e459a0f188e000b00df34b">db_col_valid</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col)</td></tr>
<tr class="separator:a1ba6deeca3e459a0f188e000b00df34b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc515b86a8eb3d85978249a90fdd59f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#abc515b86a8eb3d85978249a90fdd59f2">db_col_action_valid</a> (const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, uint32_t action)</td></tr>
<tr class="separator:abc515b86a8eb3d85978249a90fdd59f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f5027336c8965c51541b7bf5b370d51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a1f5027336c8965c51541b7bf5b370d51">db_col_merge</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col_dst, struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col_src)</td></tr>
<tr class="separator:a1f5027336c8965c51541b7bf5b370d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cce96dcae72353b5ac0ce0c7398f39e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a9cce96dcae72353b5ac0ce0c7398f39e">db_col_arch_exist</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, uint32_t arch_token)</td></tr>
<tr class="separator:a9cce96dcae72353b5ac0ce0c7398f39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e56ca5d2ff41d0a28b5b0b5aa46a9b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a1e56ca5d2ff41d0a28b5b0b5aa46a9b5">db_col_attr_get</a> (const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a> attr, uint32_t *value)</td></tr>
<tr class="separator:a1e56ca5d2ff41d0a28b5b0b5aa46a9b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c40a4f61d148d117e7cd5329c9d252a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a7c40a4f61d148d117e7cd5329c9d252a">db_col_attr_read</a> (const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a> attr)</td></tr>
<tr class="separator:a7c40a4f61d148d117e7cd5329c9d252a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9468e4914d2a78617014682865da9272"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a9468e4914d2a78617014682865da9272">db_col_attr_set</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a> attr, uint32_t value)</td></tr>
<tr class="separator:a9468e4914d2a78617014682865da9272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd458451c6a5668a34f4c2724cae8a35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#afd458451c6a5668a34f4c2724cae8a35">db_col_db_new</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>)</td></tr>
<tr class="separator:afd458451c6a5668a34f4c2724cae8a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a4149b173bbe818251981830f5a1f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a85a4149b173bbe818251981830f5a1f9">db_col_db_add</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, struct <a class="el" href="structdb__filter.html">db_filter</a> *db)</td></tr>
<tr class="separator:a85a4149b173bbe818251981830f5a1f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add2cc09a37eb28a15c02c00ae636a52d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#add2cc09a37eb28a15c02c00ae636a52d">db_col_db_remove</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, uint32_t arch_token)</td></tr>
<tr class="separator:add2cc09a37eb28a15c02c00ae636a52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d5236614aad016fd3945304b33ff3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a22d5236614aad016fd3945304b33ff3f">db_rule_add</a> (struct <a class="el" href="structdb__filter.html">db_filter</a> *db, const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *rule)</td></tr>
<tr class="separator:a22d5236614aad016fd3945304b33ff3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6c0fb675068b5850614407cf4d7b36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a6f6c0fb675068b5850614407cf4d7b36">db_col_syscall_priority</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, int syscall, uint8_t priority)</td></tr>
<tr class="separator:a6f6c0fb675068b5850614407cf4d7b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6905f54739e91f134e5b2bbec242259"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#aa6905f54739e91f134e5b2bbec242259">db_col_rule_add</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, bool strict, uint32_t action, int syscall, unsigned int arg_cnt, const struct <a class="el" href="structscmp__arg__cmp.html">scmp_arg_cmp</a> *arg_array)</td></tr>
<tr class="separator:aa6905f54739e91f134e5b2bbec242259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc26a77140e106783fd0893f5f23d590"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#abc26a77140e106783fd0893f5f23d590">db_col_transaction_start</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col)</td></tr>
<tr class="separator:abc26a77140e106783fd0893f5f23d590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d234da61e4a5eb831d418f53797422b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a1d234da61e4a5eb831d418f53797422b">db_col_transaction_abort</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col)</td></tr>
<tr class="separator:a1d234da61e4a5eb831d418f53797422b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bb8785e274040fc86e8d7745be1f2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="db_8c.html#a55bb8785e274040fc86e8d7745be1f2b">db_col_transaction_commit</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col)</td></tr>
<tr class="separator:a55bb8785e274040fc86e8d7745be1f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a090399e38d155994d96ce07ef3527c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a090399e38d155994d96ce07ef3527c3e">&#9670;&nbsp;</a></span>_DB_IST_M_MATCHSET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_M_MATCHSET&#160;&#160;&#160;(<a class="el" href="db_8c.html#a1822b35342fb6811a2461c5b764cb82e">_DB_IST_MATCH</a>|<a class="el" href="db_8c.html#a0e9095bc2f711e3cea2dd0009234b2f5">_DB_IST_MATCH_ONCE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00057">57</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="acf706efac6834cdbcc4f3bc2f08a0bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf706efac6834cdbcc4f3bc2f08a0bd0">&#9670;&nbsp;</a></span>_DB_IST_M_REDUNDANT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_M_REDUNDANT</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">                     (<a class="code" href="db_8c.html#a1822b35342fb6811a2461c5b764cb82e">_DB_IST_MATCH</a>| \</div>
<div class="line">                     _DB_IST_X_FINISHED| \</div>
<div class="line">                     _DB_IST_N_PREFIX)</div>
<div class="ttc" id="adb_8c_html_a1822b35342fb6811a2461c5b764cb82e"><div class="ttname"><a href="db_8c.html#a1822b35342fb6811a2461c5b764cb82e">_DB_IST_MATCH</a></div><div class="ttdeci">#define _DB_IST_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="db_8c_source.html#l00051">db.c:51</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00058">58</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a1822b35342fb6811a2461c5b764cb82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1822b35342fb6811a2461c5b764cb82e">&#9670;&nbsp;</a></span>_DB_IST_MATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_MATCH&#160;&#160;&#160;0x00000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00051">51</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a0e9095bc2f711e3cea2dd0009234b2f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9095bc2f711e3cea2dd0009234b2f5">&#9670;&nbsp;</a></span>_DB_IST_MATCH_ONCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_MATCH_ONCE&#160;&#160;&#160;0x00000002</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00052">52</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="acfa5151c1608cd88ac5438a862da0a63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa5151c1608cd88ac5438a862da0a63">&#9670;&nbsp;</a></span>_DB_IST_N_FINISHED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_N_FINISHED&#160;&#160;&#160;0x00000020</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00054">54</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="ae97fc2b3f8442d2f3c5bb29c0415ce5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae97fc2b3f8442d2f3c5bb29c0415ce5f">&#9670;&nbsp;</a></span>_DB_IST_N_PREFIX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_N_PREFIX&#160;&#160;&#160;0x00000200</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00056">56</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a38945a7d0dc364f60618d25f57392671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38945a7d0dc364f60618d25f57392671">&#9670;&nbsp;</a></span>_DB_IST_NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_NONE&#160;&#160;&#160;0x00000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00050">50</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="ae043100fef5f7300a64f9a27c8458b54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae043100fef5f7300a64f9a27c8458b54">&#9670;&nbsp;</a></span>_DB_IST_X_FINISHED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_X_FINISHED&#160;&#160;&#160;0x00000010</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00053">53</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="ac7283197f8fca88fca16d274ba18b675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7283197f8fca88fca16d274ba18b675">&#9670;&nbsp;</a></span>_DB_IST_X_PREFIX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_IST_X_PREFIX&#160;&#160;&#160;0x00000100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00055">55</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a421d4e235d561538df77ba2151748032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421d4e235d561538df77ba2151748032">&#9670;&nbsp;</a></span>_DB_PRI_MASK_CHAIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_PRI_MASK_CHAIN&#160;&#160;&#160;0x0000FFFF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00044">44</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a9ae85d0cd768a0726fac83cadead8c41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ae85d0cd768a0726fac83cadead8c41">&#9670;&nbsp;</a></span>_DB_PRI_MASK_USER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_PRI_MASK_USER&#160;&#160;&#160;0x00FF0000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00045">45</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="abe866f96ce15729601dc44ffcaa93f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe866f96ce15729601dc44ffcaa93f08">&#9670;&nbsp;</a></span>_DB_PRI_USER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_PRI_USER</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &lt;&lt; 16) &amp; <a class="el" href="db_8c.html#a9ae85d0cd768a0726fac83cadead8c41">_DB_PRI_MASK_USER</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00046">46</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a13bdcb595412250ba2b9ef802372dc3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13bdcb595412250ba2b9ef802372dc3b">&#9670;&nbsp;</a></span>_DB_STA_FREED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_STA_FREED&#160;&#160;&#160;0x1A2B3C4D</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00039">39</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a98728e9da07433fdf1874b0b13601ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98728e9da07433fdf1874b0b13601ff2">&#9670;&nbsp;</a></span>_DB_STA_VALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DB_STA_VALID&#160;&#160;&#160;0xA1B2C3D4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enhanced Seccomp Filter DB</p>
<p>Copyright (c) 2012,2016,2018 Red Hat <a href="#" onclick="location.href='mai'+'lto:'+'pmo'+'or'+'e@r'+'ed'+'hat'+'.c'+'om'; return false;">pmoor<span style="display: none;">.nosp@m.</span>e@re<span style="display: none;">.nosp@m.</span>dhat.<span style="display: none;">.nosp@m.</span>com</a> Copyright (c) 2019 Cisco Systems, Inc. <a href="#" onclick="location.href='mai'+'lto:'+'pmo'+'or'+'e2@'+'ci'+'sco'+'.c'+'om'; return false;">pmoor<span style="display: none;">.nosp@m.</span>e2@c<span style="display: none;">.nosp@m.</span>isco.<span style="display: none;">.nosp@m.</span>com</a> Author: Paul Moore <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'l@'+'pau'+'l-'+'moo'+'re'+'.co'+'m'; return false;">paul@<span style="display: none;">.nosp@m.</span>paul<span style="display: none;">.nosp@m.</span>-moor<span style="display: none;">.nosp@m.</span>e.co<span style="display: none;">.nosp@m.</span>m</a> </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l00038">38</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abc515b86a8eb3d85978249a90fdd59f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc515b86a8eb3d85978249a90fdd59f2">&#9670;&nbsp;</a></span>db_col_action_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_action_valid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate the seccomp action </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">action</td><td>the seccomp action</td></tr>
  </table>
  </dd>
</dl>
<p>Verify that the given action is a valid seccomp action; return zero if valid, -EINVAL if invalid. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01192">1192</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a9cce96dcae72353b5ac0ce0c7398f39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cce96dcae72353b5ac0ce0c7398f39e">&#9670;&nbsp;</a></span>db_col_arch_exist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_arch_exist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>arch_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if an architecture filter exists in the filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">arch_token</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>Iterate through the given filter collection checking to see if a filter exists for the specified architecture. Returns -EEXIST if a filter is found, zero if a matching filter does not exist. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01270">1270</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a1e56ca5d2ff41d0a28b5b0b5aa46a9b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e56ca5d2ff41d0a28b5b0b5aa46a9b5">&#9670;&nbsp;</a></span>db_col_attr_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_attr_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a>&#160;</td>
          <td class="paramname"><em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a filter attribute </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">attr</td><td>the filter attribute </td></tr>
    <tr><td class="paramname">value</td><td>the filter attribute value</td></tr>
  </table>
  </dd>
</dl>
<p>Get the requested filter attribute and provide it via @value. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01291">1291</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a7c40a4f61d148d117e7cd5329c9d252a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c40a4f61d148d117e7cd5329c9d252a">&#9670;&nbsp;</a></span>db_col_attr_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t db_col_attr_read </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a>&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a filter attribute </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">attr</td><td>the filter attribute</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the requested filter attribute value with zero on any error. Special care must be given with this function as error conditions can be hidden from the caller. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01342">1342</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a9468e4914d2a78617014682865da9272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9468e4914d2a78617014682865da9272">&#9670;&nbsp;</a></span>db_col_attr_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_attr_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="seccomp_8h.html#a20d316b7e610ae94365a29809b92f44c">scmp_filter_attr</a>&#160;</td>
          <td class="paramname"><em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a filter attribute </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">attr</td><td>the filter attribute </td></tr>
    <tr><td class="paramname">value</td><td>the filter attribute value</td></tr>
  </table>
  </dd>
</dl>
<p>Set the requested filter attribute with the given value. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01361">1361</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a85a4149b173bbe818251981830f5a1f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a4149b173bbe818251981830f5a1f9">&#9670;&nbsp;</a></span>db_col_db_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_db_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdb__filter.html">db_filter</a> *&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new filter DB to a filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">db</td><td>the seccomp filter DB</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds an existing seccomp filter DB to an existing seccomp filter collection assuming there isn't a filter DB already present with the same architecture. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01477">1477</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="afd458451c6a5668a34f4c2724cae8a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd458451c6a5668a34f4c2724cae8a35">&#9670;&nbsp;</a></span>db_col_db_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_db_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new architecture filter to a filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">arch</td><td>the architecture</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds a new architecture filter DB to an existing seccomp filter collection assuming there isn't a filter DB already present with the same architecture. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01452">1452</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="add2cc09a37eb28a15c02c00ae636a52d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add2cc09a37eb28a15c02c00ae636a52d">&#9670;&nbsp;</a></span>db_col_db_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_db_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>arch_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a filter DB from a filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">arch_token</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>This function removes an existing seccomp filter DB from an existing seccomp filter collection. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01509">1509</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="afce7caff59161c658d06d61d63034ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce7caff59161c658d06d61d63034ee1">&#9670;&nbsp;</a></span>db_col_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a>* db_col_init </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>def_action</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Intitalize a seccomp filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">def_action</td><td>the default filter action</td></tr>
  </table>
  </dd>
</dl>
<p>This function initializes a seccomp filter collection and readies it for use. Returns a pointer to the collection on success, NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01112">1112</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a1f5027336c8965c51541b7bf5b370d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f5027336c8965c51541b7bf5b370d51">&#9670;&nbsp;</a></span>db_col_merge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_merge </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col_src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merge two filter collections </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col_dst</td><td>the destination filter collection </td></tr>
    <tr><td class="paramname">col_src</td><td>the source filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function merges two filter collections into the given destination collection. The source filter collection is no longer valid if the function returns successfully. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01220">1220</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="ac93ca148cd3ffebba2016403551bf2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac93ca148cd3ffebba2016403551bf2d2">&#9670;&nbsp;</a></span>db_col_release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void db_col_release </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroy a seccomp filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function destroys a seccomp filter collection. After calling this function, the filter should no longer be referenced. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01139">1139</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a88ba803a28b8aeb6cf4dc07906129736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88ba803a28b8aeb6cf4dc07906129736">&#9670;&nbsp;</a></span>db_col_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>def_action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free and reset the seccomp filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection </td></tr>
    <tr><td class="paramname">def_action</td><td>the default filter action</td></tr>
  </table>
  </dd>
</dl>
<p>This function frees any existing filter DBs and resets the collection to a default state. In the case of failure the filter collection may be in an unknown state and should be released. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01044">1044</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="aa6905f54739e91f134e5b2bbec242259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6905f54739e91f134e5b2bbec242259">&#9670;&nbsp;</a></span>db_col_rule_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_rule_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>strict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>syscall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg_cnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structscmp__arg__cmp.html">scmp_arg_cmp</a> *&#160;</td>
          <td class="paramname"><em>arg_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new rule to the current filter </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection </td></tr>
    <tr><td class="paramname">strict</td><td>the strict flag </td></tr>
    <tr><td class="paramname">action</td><td>the filter action </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number </td></tr>
    <tr><td class="paramname">arg_cnt</td><td>the number of argument filters in the argument filter chain </td></tr>
    <tr><td class="paramname">arg_array</td><td>the argument filter chain, (uint, enum scmp_compare, ulong)</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds a new argument/comparison/value to the seccomp filter for a syscall; multiple arguments can be specified and they will be chained together (essentially AND'd together) in the filter. When the strict flag is true the function will fail if the exact rule can not be added to the filter, if the strict flag is false the function will not fail if the function needs to adjust the rule due to architecture specifics. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02295">2295</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a6f6c0fb675068b5850614407cf4d7b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6c0fb675068b5850614407cf4d7b36">&#9670;&nbsp;</a></span>db_col_syscall_priority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_syscall_priority </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>syscall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the priority of a given syscall </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number </td></tr>
    <tr><td class="paramname">priority</td><td>priority value, higher value == higher priority</td></tr>
  </table>
  </dd>
</dl>
<p>This function sets the priority of the given syscall; this value is used when generating the seccomp filter code such that higher priority syscalls will incur less filter code overhead than the lower priority syscalls in the filter. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02198">2198</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a1d234da61e4a5eb831d418f53797422b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d234da61e4a5eb831d418f53797422b">&#9670;&nbsp;</a></span>db_col_transaction_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void db_col_transaction_abort </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Abort the top most seccomp filter transaction </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function aborts the most recent seccomp filter transaction. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02481">2481</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a55bb8785e274040fc86e8d7745be1f2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55bb8785e274040fc86e8d7745be1f2b">&#9670;&nbsp;</a></span>db_col_transaction_commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void db_col_transaction_commit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Commit the top most seccomp filter transaction </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function commits the most recent seccomp filter transaction and attempts to create a shadow transaction that is a duplicate of the current filter to speed up future transactions. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02515">2515</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="abc26a77140e106783fd0893f5f23d590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc26a77140e106783fd0893f5f23d590">&#9670;&nbsp;</a></span>db_col_transaction_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_transaction_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a new seccomp filter transaction </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function starts a new seccomp filter transaction for the given filter collection. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02395">2395</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a1ba6deeca3e459a0f188e000b00df34b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ba6deeca3e459a0f188e000b00df34b">&#9670;&nbsp;</a></span>db_col_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_col_valid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate a filter collection </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the seccomp filter collection</td></tr>
  </table>
  </dd>
</dl>
<p>This function validates a seccomp filter collection. Returns zero if the collection is valid, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01177">1177</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a22d5236614aad016fd3945304b33ff3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d5236614aad016fd3945304b33ff3f">&#9670;&nbsp;</a></span>db_rule_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int db_rule_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter.html">db_filter</a> *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *&#160;</td>
          <td class="paramname"><em>rule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new rule to the seccomp filter DB </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>the seccomp filter db </td></tr>
    <tr><td class="paramname">rule</td><td>the filter rule</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds a new syscall filter to the seccomp filter DB, adding to the existing filters for the syscall, unless no argument specific filters are present (filtering only on the syscall). When adding new chains, the shortest chain, or most inclusive filter match, will be entered into the filter DB. Returns zero on success, negative values on failure.</p>
<p>It is important to note that in the case of failure the db may be corrupted, the caller must use the transaction mechanism if the db integrity is important. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l02062">2062</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
<a id="a718c80b8eadb17f68928b99a1628192b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a718c80b8eadb17f68928b99a1628192b">&#9670;&nbsp;</a></span>db_rule_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a>* db_rule_dup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Duplicate an existing filter rule </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>the rule to duplicate</td></tr>
  </table>
  </dd>
</dl>
<p>This function makes an exact copy of the given rule, but does not add it to any lists. Returns a pointer to the new rule on success, NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="db_8c_source.html#l01019">1019</a> of file <a class="el" href="db_8c_source.html">db.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
