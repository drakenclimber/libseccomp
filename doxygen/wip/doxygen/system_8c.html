<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libseccomp: src/system.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libseccomp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">system.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;sys/prctl.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;<a class="el" href="system_8h_source.html">system.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="seccomp_8h_source.html">seccomp.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="arch_8h_source.html">arch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="db_8h_source.html">db.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gen__bpf_8h_source.html">gen_bpf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="helper_8h_source.html">helper.h</a>&quot;</code><br />
</div>
<p><a href="system_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtask__state.html">task_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b0eacb8e0a98591edcf36aa0ab5a70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a63b0eacb8e0a98591edcf36aa0ab5a70">SYSCALL_ALLOWLIST_ENABLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a63b0eacb8e0a98591edcf36aa0ab5a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae0d58b0995e3ff016989be34867e55be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#ae0d58b0995e3ff016989be34867e55be">sys_reset_state</a> (void)</td></tr>
<tr class="separator:ae0d58b0995e3ff016989be34867e55be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9681767625723b9f5eefa3c1479ef922"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a9681767625723b9f5eefa3c1479ef922">sys_chk_seccomp_syscall</a> (void)</td></tr>
<tr class="separator:a9681767625723b9f5eefa3c1479ef922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb0502a3e011199e88b9a62ac0094adb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#acb0502a3e011199e88b9a62ac0094adb">sys_set_seccomp_syscall</a> (bool enable)</td></tr>
<tr class="separator:acb0502a3e011199e88b9a62ac0094adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bfb57aecfbc6d6c5d5e7ac1b9a15795"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a1bfb57aecfbc6d6c5d5e7ac1b9a15795">sys_chk_seccomp_action</a> (uint32_t action)</td></tr>
<tr class="separator:a1bfb57aecfbc6d6c5d5e7ac1b9a15795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3029e6322393bfd7d47d1fc2ba0a4fc3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a3029e6322393bfd7d47d1fc2ba0a4fc3">sys_set_seccomp_action</a> (uint32_t action, bool enable)</td></tr>
<tr class="separator:a3029e6322393bfd7d47d1fc2ba0a4fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519afb82cac2f23ffa1a4f2ae0cc1c2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a519afb82cac2f23ffa1a4f2ae0cc1c2e">sys_chk_seccomp_flag</a> (int flag)</td></tr>
<tr class="separator:a519afb82cac2f23ffa1a4f2ae0cc1c2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df78b28d726158fea7a08756c9acf15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a4df78b28d726158fea7a08756c9acf15">sys_set_seccomp_flag</a> (int flag, bool enable)</td></tr>
<tr class="separator:a4df78b28d726158fea7a08756c9acf15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe3b09e97473583246275b02f91f95a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a9fe3b09e97473583246275b02f91f95a">sys_filter_load</a> (struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *col, bool rawrc)</td></tr>
<tr class="separator:a9fe3b09e97473583246275b02f91f95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a500bd23df908ddcf42055675d30e98a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a500bd23df908ddcf42055675d30e98a7">sys_notify_fd</a> (void)</td></tr>
<tr class="separator:a500bd23df908ddcf42055675d30e98a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4031b7d2a67f9263da5e5aaa849c2ac8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a4031b7d2a67f9263da5e5aaa849c2ac8">sys_notify_alloc</a> (struct <a class="el" href="structseccomp__notif.html">seccomp_notif</a> **req, struct <a class="el" href="structseccomp__notif__resp.html">seccomp_notif_resp</a> **resp)</td></tr>
<tr class="separator:a4031b7d2a67f9263da5e5aaa849c2ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72097a60fa7cacf5a106b2dd7e05667f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#a72097a60fa7cacf5a106b2dd7e05667f">sys_notify_receive</a> (int fd, struct <a class="el" href="structseccomp__notif.html">seccomp_notif</a> *req)</td></tr>
<tr class="separator:a72097a60fa7cacf5a106b2dd7e05667f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea7c11329a834cee68c4ad0b9fd578d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#afea7c11329a834cee68c4ad0b9fd578d">sys_notify_respond</a> (int fd, struct <a class="el" href="structseccomp__notif__resp.html">seccomp_notif_resp</a> *resp)</td></tr>
<tr class="separator:afea7c11329a834cee68c4ad0b9fd578d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f60115784f7032ac3e09494319c872"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8c.html#aa8f60115784f7032ac3e09494319c872">sys_notify_id_valid</a> (int fd, uint64_t id)</td></tr>
<tr class="separator:aa8f60115784f7032ac3e09494319c872"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&nbsp;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Seccomp System Interfaces</p>
<p>Copyright (c) 2014 Red Hat <a href="#" onclick="location.href='mai'+'lto:'+'pmo'+'or'+'e@r'+'ed'+'hat'+'.c'+'om'; return false;">pmoor<span style="display: none;">.nosp@m.</span>e@re<span style="display: none;">.nosp@m.</span>dhat.<span style="display: none;">.nosp@m.</span>com</a> Author: Paul Moore <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'l@'+'pau'+'l-'+'moo'+'re'+'.co'+'m'; return false;">paul@<span style="display: none;">.nosp@m.</span>paul<span style="display: none;">.nosp@m.</span>-moor<span style="display: none;">.nosp@m.</span>e.co<span style="display: none;">.nosp@m.</span>m</a> </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00026">26</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a63b0eacb8e0a98591edcf36aa0ab5a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63b0eacb8e0a98591edcf36aa0ab5a70">&#9670;&nbsp;</a></span>SYSCALL_ALLOWLIST_ENABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SYSCALL_ALLOWLIST_ENABLE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00041">41</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1bfb57aecfbc6d6c5d5e7ac1b9a15795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bfb57aecfbc6d6c5d5e7ac1b9a15795">&#9670;&nbsp;</a></span>sys_chk_seccomp_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_chk_seccomp_action </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>action</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if a seccomp action is supported </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>the seccomp action</td></tr>
  </table>
  </dd>
</dl>
<p>This function checks to see if a seccomp action is supported by the system. Return one if the action is supported, zero otherwise. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00181">181</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a519afb82cac2f23ffa1a4f2ae0cc1c2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519afb82cac2f23ffa1a4f2ae0cc1c2e">&#9670;&nbsp;</a></span>sys_chk_seccomp_flag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_chk_seccomp_flag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if a seccomp() flag is supported </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag</td><td>the seccomp() flag</td></tr>
  </table>
  </dd>
</dl>
<p>This function checks to see if a seccomp() flag is supported by the system. Return one if the syscall is supported, zero if unsupported, negative values on error. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00287">287</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a9681767625723b9f5eefa3c1479ef922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9681767625723b9f5eefa3c1479ef922">&#9670;&nbsp;</a></span>sys_chk_seccomp_syscall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_chk_seccomp_syscall </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if the seccomp() syscall is supported</p>
<p>This function attempts to see if the system supports the seccomp() syscall. Unfortunately, there are a few reasons why this check may fail, including a previously loaded seccomp filter, so it is hard to say for certain. Return one if the syscall is supported, zero otherwise. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00112">112</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a9fe3b09e97473583246275b02f91f95a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe3b09e97473583246275b02f91f95a">&#9670;&nbsp;</a></span>sys_filter_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_filter_load </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter__col.html">db_filter_col</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rawrc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads the filter into the kernel </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col</td><td>the filter collection </td></tr>
    <tr><td class="paramname">rawrc</td><td>pass the raw return code if true</td></tr>
  </table>
  </dd>
</dl>
<p>This function loads the given seccomp filter context into the kernel. If the filter was loaded correctly, the kernel will be enforcing the filter when this function returns. Returns zero on success, negative values on error. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00356">356</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a4031b7d2a67f9263da5e5aaa849c2ac8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4031b7d2a67f9263da5e5aaa849c2ac8">&#9670;&nbsp;</a></span>sys_notify_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_notify_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structseccomp__notif.html">seccomp_notif</a> **&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structseccomp__notif__resp.html">seccomp_notif_resp</a> **&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a pair of notification request/response structures </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>the request location </td></tr>
    <tr><td class="paramname">resp</td><td>the response location</td></tr>
  </table>
  </dd>
</dl>
<p>This function allocates a pair of request/response structure by computing the correct sized based on the currently running kernel. It returns zero on success, and negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00451">451</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a500bd23df908ddcf42055675d30e98a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a500bd23df908ddcf42055675d30e98a7">&#9670;&nbsp;</a></span>sys_notify_fd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_notify_fd </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the userspace notification fd</p>
<p>This function returns the userspace notification fd from SECCOMP_FILTER_FLAG_NEW_LISTENER. If the notification fd has not yet been set, or an error has occurred, -1 is returned. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00436">436</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="aa8f60115784f7032ac3e09494319c872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f60115784f7032ac3e09494319c872">&#9670;&nbsp;</a></span>sys_notify_id_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_notify_id_valid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if a notification id is still valid </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>the notification fd </td></tr>
    <tr><td class="paramname">id</td><td>the id to test</td></tr>
  </table>
  </dd>
</dl>
<p>Checks to see if a notification id is still valid. Returns 0 on success, and negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00536">536</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a72097a60fa7cacf5a106b2dd7e05667f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72097a60fa7cacf5a106b2dd7e05667f">&#9670;&nbsp;</a></span>sys_notify_receive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_notify_receive </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structseccomp__notif.html">seccomp_notif</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Receive a notification from a seccomp notification fd </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>the notification fd </td></tr>
    <tr><td class="paramname">req</td><td>the request buffer to save into</td></tr>
  </table>
  </dd>
</dl>
<p>Blocks waiting for a notification on this fd. This function is thread safe (synchronization is performed in the kernel). Returns zero on success, negative values on error. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00496">496</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="afea7c11329a834cee68c4ad0b9fd578d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea7c11329a834cee68c4ad0b9fd578d">&#9670;&nbsp;</a></span>sys_notify_respond()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_notify_respond </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structseccomp__notif__resp.html">seccomp_notif_resp</a> *&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a notification response to a seccomp notification fd </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>the notification fd </td></tr>
    <tr><td class="paramname">resp</td><td>the response buffer to use</td></tr>
  </table>
  </dd>
</dl>
<p>Sends a notification response on this fd. This function is thread safe (synchronization is performed in the kernel). Returns zero on success, negative values on error. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00517">517</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="ae0d58b0995e3ff016989be34867e55be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0d58b0995e3ff016989be34867e55be">&#9670;&nbsp;</a></span>sys_reset_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_reset_state </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset the task state</p>
<p>This function fully resets the library's global "system task state". </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00084">84</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a3029e6322393bfd7d47d1fc2ba0a4fc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3029e6322393bfd7d47d1fc2ba0a4fc3">&#9670;&nbsp;</a></span>sys_set_seccomp_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_set_seccomp_action </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force a seccomp action support setting </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>the seccomp action </td></tr>
    <tr><td class="paramname">enable</td><td>the intended support state</td></tr>
  </table>
  </dd>
</dl>
<p>This function overrides the current seccomp action support setting; this is very much a "use at your own risk" function. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00241">241</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="a4df78b28d726158fea7a08756c9acf15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df78b28d726158fea7a08756c9acf15">&#9670;&nbsp;</a></span>sys_set_seccomp_flag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_set_seccomp_flag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force a seccomp() syscall flag support setting </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag</td><td>the seccomp() flag </td></tr>
    <tr><td class="paramname">enable</td><td>the intended support state</td></tr>
  </table>
  </dd>
</dl>
<p>This function overrides the current seccomp() syscall support setting for a given flag; this is very much a "use at your own risk" function. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00324">324</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
<a id="acb0502a3e011199e88b9a62ac0094adb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb0502a3e011199e88b9a62ac0094adb">&#9670;&nbsp;</a></span>sys_set_seccomp_syscall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_set_seccomp_syscall </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force the seccomp() syscall support setting </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">enable</td><td>the intended support state</td></tr>
  </table>
  </dd>
</dl>
<p>This function overrides the current seccomp() syscall support setting; this is very much a "use at your own risk" function. </p>

<p class="definition">Definition at line <a class="el" href="system_8c_source.html#l00168">168</a> of file <a class="el" href="system_8c_source.html">system.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
