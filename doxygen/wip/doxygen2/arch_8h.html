<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libseccomp: src/arch.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libseccomp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">arch.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;<a class="el" href="seccomp_8h_source.html">seccomp.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="system_8h_source.html">system.h</a>&quot;</code><br />
</div>
<p><a href="arch_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structarch__def.html">arch_def</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structarch__syscall__def.html">arch_syscall_def</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af916e0ada1d8f79f596b5f499161cc3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#af916e0ada1d8f79f596b5f499161cc3d">ARCH_DECL</a>(NAME)</td></tr>
<tr class="separator:af916e0ada1d8f79f596b5f499161cc3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae084e51797ed12b32fa5dbab6de4c423"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ae084e51797ed12b32fa5dbab6de4c423">ARCH_DEF</a>(NAME)</td></tr>
<tr class="separator:ae084e51797ed12b32fa5dbab6de4c423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45e67cb63679880ac5238f840e1acb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ad45e67cb63679880ac5238f840e1acb3">DATUM_MAX</a>&#160;&#160;&#160;((<a class="el" href="seccomp_8h.html#acdfae9a94f1955b7fee43f46654fb343">scmp_datum_t</a>)-1)</td></tr>
<tr class="separator:ad45e67cb63679880ac5238f840e1acb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a7e89a40c94da8a3ade31942b07b30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a40a7e89a40c94da8a3ade31942b07b30">D64_LO</a>(x)&#160;&#160;&#160;((uint32_t)((uint64_t)(x) &amp; 0x00000000ffffffff))</td></tr>
<tr class="separator:a40a7e89a40c94da8a3ade31942b07b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604b03a4cf4ad419a4a4c5ddc2c46027"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a604b03a4cf4ad419a4a4c5ddc2c46027">D64_HI</a>(x)&#160;&#160;&#160;((uint32_t)((uint64_t)(x) &gt;&gt; 32))</td></tr>
<tr class="separator:a604b03a4cf4ad419a4a4c5ddc2c46027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54239a6e43352dff05eb93eaa49112e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ad54239a6e43352dff05eb93eaa49112e">ARG_COUNT_MAX</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ad54239a6e43352dff05eb93eaa49112e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a579276fd8570ba70c8bc58e0095992dd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a579276fd8570ba70c8bc58e0095992dd">arch_valid</a> (uint32_t <a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>)</td></tr>
<tr class="separator:a579276fd8570ba70c8bc58e0095992dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af18ae35357a900fe01236d72a444eb14"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#af18ae35357a900fe01236d72a444eb14">arch_def_lookup</a> (uint32_t token)</td></tr>
<tr class="separator:af18ae35357a900fe01236d72a444eb14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93d63209c3892586bee06d573e2cb67"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#aa93d63209c3892586bee06d573e2cb67">arch_def_lookup_name</a> (const char *arch_name)</td></tr>
<tr class="separator:aa93d63209c3892586bee06d573e2cb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac598794e8dd44abe0b23106441cc28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a0ac598794e8dd44abe0b23106441cc28">arch_arg_offset_lo</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:a0ac598794e8dd44abe0b23106441cc28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198eb9d70c8f7cd6a79b96503349fbdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a198eb9d70c8f7cd6a79b96503349fbdf">arch_arg_offset_hi</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:a198eb9d70c8f7cd6a79b96503349fbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f11f18efd818fe4d492ff77734b9cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ae3f11f18efd818fe4d492ff77734b9cc">arch_arg_offset</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:ae3f11f18efd818fe4d492ff77734b9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae892194241477b41ee0b221d072af5f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ae892194241477b41ee0b221d072af5f3">arch_syscall_resolve_name</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, const char *name)</td></tr>
<tr class="separator:ae892194241477b41ee0b221d072af5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f1e7662220f5dccc86b07bb71b19e96"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a6f1e7662220f5dccc86b07bb71b19e96">arch_syscall_resolve_num</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int num)</td></tr>
<tr class="separator:a6f1e7662220f5dccc86b07bb71b19e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffc4683b4a77cdd29225036b5d81241"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a1ffc4683b4a77cdd29225036b5d81241">arch_syscall_translate</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int *syscall)</td></tr>
<tr class="separator:a1ffc4683b4a77cdd29225036b5d81241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794aab2ebc0d182ef584e2844d572957"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a794aab2ebc0d182ef584e2844d572957">arch_syscall_rewrite</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int *syscall)</td></tr>
<tr class="separator:a794aab2ebc0d182ef584e2844d572957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8466d6058b4e188063f954ef6741005"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#ab8466d6058b4e188063f954ef6741005">arch_filter_rule_add</a> (struct <a class="el" href="structdb__filter.html">db_filter</a> *db, const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *rule)</td></tr>
<tr class="separator:ab8466d6058b4e188063f954ef6741005"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a776ca0cddfc4684d582d82b0d0f1b93a"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8h.html#a776ca0cddfc4684d582d82b0d0f1b93a">arch_def_native</a></td></tr>
<tr class="separator:a776ca0cddfc4684d582d82b0d0f1b93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af916e0ada1d8f79f596b5f499161cc3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af916e0ada1d8f79f596b5f499161cc3d">&#9670;&nbsp;</a></span>ARCH_DECL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARCH_DECL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">NAME</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structarch__def.html">arch_def</a> arch_def_##NAME; \</div>
<div class="line">    int NAME##_syscall_resolve_name(<span class="keyword">const</span> <span class="keywordtype">char</span> *name); \</div>
<div class="line">    const <span class="keywordtype">char</span> *NAME##_syscall_resolve_num(<span class="keywordtype">int</span> num); \</div>
<div class="line">    const <span class="keyword">struct </span><a class="code" href="structarch__syscall__def.html">arch_syscall_def</a> *NAME##_syscall_iterate(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> spot);</div>
<div class="ttc" id="astructarch__def_html"><div class="ttname"><a href="structarch__def.html">arch_def</a></div><div class="ttdef"><b>Definition:</b> <a href="arch_8h_source.html#l00037">arch.h:37</a></div></div>
<div class="ttc" id="astructarch__syscall__def_html"><div class="ttname"><a href="structarch__syscall__def.html">arch_syscall_def</a></div><div class="ttdef"><b>Definition:</b> <a href="arch_8h_source.html#l00093">arch.h:93</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00071">71</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<a id="ae084e51797ed12b32fa5dbab6de4c423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae084e51797ed12b32fa5dbab6de4c423">&#9670;&nbsp;</a></span>ARCH_DEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARCH_DEF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">NAME</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordtype">int</span> NAME##_syscall_resolve_name(<span class="keyword">const</span> <span class="keywordtype">char</span> *name) \</div>
<div class="line">    { \</div>
<div class="line">        return <a class="code" href="syscalls_8h.html#a4e77fbde4422e536909b93e2611d98cf">syscall_resolve_name</a>(name, <a class="code" href="syscalls_8h.html#acce0171fd84e79440debc70bd2d37ff6">OFFSET_ARCH</a>(NAME)); \</div>
<div class="line">    } \</div>
<div class="line">    const <span class="keywordtype">char</span> *NAME##_syscall_resolve_num(<span class="keywordtype">int</span> num) \</div>
<div class="line">    { \</div>
<div class="line">        return <a class="code" href="syscalls_8h.html#aa7bb817297085c06fa1a78c236d0fe87">syscall_resolve_num</a>(num, <a class="code" href="syscalls_8h.html#acce0171fd84e79440debc70bd2d37ff6">OFFSET_ARCH</a>(NAME)); \</div>
<div class="line">    } \</div>
<div class="line">    const <span class="keyword">struct </span><a class="code" href="structarch__syscall__def.html">arch_syscall_def</a> *NAME##_syscall_iterate(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> spot) \</div>
<div class="line">    { \</div>
<div class="line">        return <a class="code" href="syscalls_8h.html#a563530a70976ec966b90a56c717eaa8f">syscall_iterate</a>(spot, <a class="code" href="syscalls_8h.html#acce0171fd84e79440debc70bd2d37ff6">OFFSET_ARCH</a>(NAME)); \</div>
<div class="line">    }</div>
<div class="ttc" id="asyscalls_8h_html_a4e77fbde4422e536909b93e2611d98cf"><div class="ttname"><a href="syscalls_8h.html#a4e77fbde4422e536909b93e2611d98cf">syscall_resolve_name</a></div><div class="ttdeci">int syscall_resolve_name(const char *name, int offset)</div></div>
<div class="ttc" id="asyscalls_8h_html_a563530a70976ec966b90a56c717eaa8f"><div class="ttname"><a href="syscalls_8h.html#a563530a70976ec966b90a56c717eaa8f">syscall_iterate</a></div><div class="ttdeci">const struct arch_syscall_def * syscall_iterate(unsigned int spot, int offset)</div></div>
<div class="ttc" id="asyscalls_8h_html_aa7bb817297085c06fa1a78c236d0fe87"><div class="ttname"><a href="syscalls_8h.html#aa7bb817297085c06fa1a78c236d0fe87">syscall_resolve_num</a></div><div class="ttdeci">const char * syscall_resolve_num(int num, int offset)</div></div>
<div class="ttc" id="asyscalls_8h_html_acce0171fd84e79440debc70bd2d37ff6"><div class="ttname"><a href="syscalls_8h.html#acce0171fd84e79440debc70bd2d37ff6">OFFSET_ARCH</a></div><div class="ttdeci">#define OFFSET_ARCH(NAME)</div><div class="ttdef"><b>Definition:</b> <a href="syscalls_8h_source.html#l00057">syscalls.h:57</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00078">78</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<a id="ad54239a6e43352dff05eb93eaa49112e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad54239a6e43352dff05eb93eaa49112e">&#9670;&nbsp;</a></span>ARG_COUNT_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARG_COUNT_MAX&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00102">102</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<a id="a604b03a4cf4ad419a4a4c5ddc2c46027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604b03a4cf4ad419a4a4c5ddc2c46027">&#9670;&nbsp;</a></span>D64_HI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define D64_HI</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((uint32_t)((uint64_t)(x) &gt;&gt; 32))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00100">100</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<a id="a40a7e89a40c94da8a3ade31942b07b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a7e89a40c94da8a3ade31942b07b30">&#9670;&nbsp;</a></span>D64_LO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define D64_LO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((uint32_t)((uint64_t)(x) &amp; 0x00000000ffffffff))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00099">99</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<a id="ad45e67cb63679880ac5238f840e1acb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad45e67cb63679880ac5238f840e1acb3">&#9670;&nbsp;</a></span>DATUM_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATUM_MAX&#160;&#160;&#160;((<a class="el" href="seccomp_8h.html#acdfae9a94f1955b7fee43f46654fb343">scmp_datum_t</a>)-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="arch_8h_source.html#l00098">98</a> of file <a class="el" href="arch_8h_source.html">arch.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae3f11f18efd818fe4d492ff77734b9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f11f18efd818fe4d492ff77734b9cc">&#9670;&nbsp;</a></span>arch_arg_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00300">300</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a198eb9d70c8f7cd6a79b96503349fbdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a198eb9d70c8f7cd6a79b96503349fbdf">&#9670;&nbsp;</a></span>arch_arg_offset_hi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset_hi </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset for the high 32 bits </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the high 32 bits of the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00273">273</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a0ac598794e8dd44abe0b23106441cc28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac598794e8dd44abe0b23106441cc28">&#9670;&nbsp;</a></span>arch_arg_offset_lo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset_lo </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset for the lower 32 bits </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the low 32 bits of the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00246">246</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="af18ae35357a900fe01236d72a444eb14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af18ae35357a900fe01236d72a444eb14">&#9670;&nbsp;</a></span>arch_def_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structarch__def.html">arch_def</a>* arch_def_lookup </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup the architecture definition </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>Return the matching architecture definition, returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00131">131</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="aa93d63209c3892586bee06d573e2cb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93d63209c3892586bee06d573e2cb67">&#9670;&nbsp;</a></span>arch_def_lookup_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structarch__def.html">arch_def</a>* arch_def_lookup_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>arch_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup the architecture definition by name </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch_name</td><td>the architecture name</td></tr>
  </table>
  </dd>
</dl>
<p>Return the matching architecture definition, returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00188">188</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="ab8466d6058b4e188063f954ef6741005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8466d6058b4e188063f954ef6741005">&#9670;&nbsp;</a></span>arch_filter_rule_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_filter_rule_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter.html">db_filter</a> *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *&#160;</td>
          <td class="paramname"><em>rule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new rule to the specified filter </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>the seccomp filter db </td></tr>
    <tr><td class="paramname">strict</td><td>the rule</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds a new argument/comparison/value to the seccomp filter for a syscall; multiple arguments can be specified and they will be chained together (essentially AND'd together) in the filter. When the strict flag is true the function will fail if the exact rule can not be added to the filter, if the strict flag is false the function will not fail if the function needs to adjust the rule due to architecture specifics. Returns zero on success, negative values on failure.</p>
<p>It is important to note that in the case of failure the db may be corrupted, the caller must use the transaction mechanism if the db integrity is important. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00430">430</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="ae892194241477b41ee0b221d072af5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae892194241477b41ee0b221d072af5f3">&#9670;&nbsp;</a></span>arch_syscall_resolve_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_resolve_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a syscall name to a number </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">name</td><td>the syscall name</td></tr>
  </table>
  </dd>
</dl>
<p>Resolve the given syscall name to the syscall number based on the given architecture. Returns the syscall number on success, including negative pseudo syscall numbers; returns __NR_SCMP_ERROR on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00315">315</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a6f1e7662220f5dccc86b07bb71b19e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f1e7662220f5dccc86b07bb71b19e96">&#9670;&nbsp;</a></span>arch_syscall_resolve_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* arch_syscall_resolve_num </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a syscall number to a name </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">num</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Resolve the given syscall number to the syscall name based on the given architecture. Returns a pointer to the syscall name string on success, including pseudo syscall names; returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00335">335</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a794aab2ebc0d182ef584e2844d572957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794aab2ebc0d182ef584e2844d572957">&#9670;&nbsp;</a></span>arch_syscall_rewrite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_rewrite </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>syscall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rewrite a syscall value to match the architecture </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Syscalls can vary across different architectures so this function rewrites the syscall into the correct value for the specified architecture. Returns zero on success, -EDOM if the syscall is not defined for @arch, and negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00390">390</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a1ffc4683b4a77cdd29225036b5d81241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffc4683b4a77cdd29225036b5d81241">&#9670;&nbsp;</a></span>arch_syscall_translate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_translate </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>syscall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate the syscall number </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Translate the syscall number, in the context of the native architecture, to the provided architecture. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00355">355</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a579276fd8570ba70c8bc58e0095992dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a579276fd8570ba70c8bc58e0095992dd">&#9670;&nbsp;</a></span>arch_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_valid </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>arch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate the architecture token </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>Verify the given architecture token; return zero if valid, -EINVAL if not. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00119">119</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a776ca0cddfc4684d582d82b0d0f1b93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776ca0cddfc4684d582d82b0d0f1b93a">&#9670;&nbsp;</a></span>arch_def_native</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structarch__def.html">arch_def</a>* arch_def_native</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
