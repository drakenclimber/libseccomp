<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libseccomp: src/arch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libseccomp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">arch.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;elf.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;asm/bitsperlong.h&gt;</code><br />
<code>#include &lt;linux/audit.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;<a class="el" href="seccomp_8h_source.html">seccomp.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="arch_8h_source.html">arch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-x86_8h_source.html">arch-x86.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-x86__64_8h_source.html">arch-x86_64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-x32_8h_source.html">arch-x32.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-arm_8h_source.html">arch-arm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-aarch64_8h_source.html">arch-aarch64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-mips_8h_source.html">arch-mips.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-mips64_8h_source.html">arch-mips64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-mips64n32_8h_source.html">arch-mips64n32.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-parisc_8h_source.html">arch-parisc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-parisc64_8h_source.html">arch-parisc64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-ppc_8h_source.html">arch-ppc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-ppc64_8h_source.html">arch-ppc64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-riscv64_8h_source.html">arch-riscv64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-s390_8h_source.html">arch-s390.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-s390x_8h_source.html">arch-s390x.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch-sh_8h_source.html">arch-sh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="db_8h_source.html">db.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system_8h_source.html">system.h</a>&quot;</code><br />
</div>
<p><a href="arch_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a05525f3702261823b10ae7042450dda1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a05525f3702261823b10ae7042450dda1">default_arg_offset</a>(x)&#160;&#160;&#160;(offsetof(struct <a class="el" href="structseccomp__data.html">seccomp_data</a>, args[x]))</td></tr>
<tr class="separator:a05525f3702261823b10ae7042450dda1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a579276fd8570ba70c8bc58e0095992dd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a579276fd8570ba70c8bc58e0095992dd">arch_valid</a> (uint32_t <a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>)</td></tr>
<tr class="separator:a579276fd8570ba70c8bc58e0095992dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af18ae35357a900fe01236d72a444eb14"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#af18ae35357a900fe01236d72a444eb14">arch_def_lookup</a> (uint32_t token)</td></tr>
<tr class="separator:af18ae35357a900fe01236d72a444eb14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93d63209c3892586bee06d573e2cb67"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#aa93d63209c3892586bee06d573e2cb67">arch_def_lookup_name</a> (const char *arch_name)</td></tr>
<tr class="separator:aa93d63209c3892586bee06d573e2cb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac598794e8dd44abe0b23106441cc28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a0ac598794e8dd44abe0b23106441cc28">arch_arg_offset_lo</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:a0ac598794e8dd44abe0b23106441cc28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198eb9d70c8f7cd6a79b96503349fbdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a198eb9d70c8f7cd6a79b96503349fbdf">arch_arg_offset_hi</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:a198eb9d70c8f7cd6a79b96503349fbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f11f18efd818fe4d492ff77734b9cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#ae3f11f18efd818fe4d492ff77734b9cc">arch_arg_offset</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, unsigned int arg)</td></tr>
<tr class="separator:ae3f11f18efd818fe4d492ff77734b9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae892194241477b41ee0b221d072af5f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#ae892194241477b41ee0b221d072af5f3">arch_syscall_resolve_name</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, const char *name)</td></tr>
<tr class="separator:ae892194241477b41ee0b221d072af5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f1e7662220f5dccc86b07bb71b19e96"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a6f1e7662220f5dccc86b07bb71b19e96">arch_syscall_resolve_num</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int num)</td></tr>
<tr class="separator:a6f1e7662220f5dccc86b07bb71b19e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffc4683b4a77cdd29225036b5d81241"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a1ffc4683b4a77cdd29225036b5d81241">arch_syscall_translate</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int *syscall)</td></tr>
<tr class="separator:a1ffc4683b4a77cdd29225036b5d81241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794aab2ebc0d182ef584e2844d572957"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#a794aab2ebc0d182ef584e2844d572957">arch_syscall_rewrite</a> (const struct <a class="el" href="structarch__def.html">arch_def</a> *<a class="el" href="util_8h.html#a5d5a5fbcc1f4a43b4cc86ee52a8903b2">arch</a>, int *syscall)</td></tr>
<tr class="separator:a794aab2ebc0d182ef584e2844d572957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8466d6058b4e188063f954ef6741005"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arch_8c.html#ab8466d6058b4e188063f954ef6741005">arch_filter_rule_add</a> (struct <a class="el" href="structdb__filter.html">db_filter</a> *db, const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *rule)</td></tr>
<tr class="separator:ab8466d6058b4e188063f954ef6741005"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a05525f3702261823b10ae7042450dda1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05525f3702261823b10ae7042450dda1">&#9670;&nbsp;</a></span>default_arg_offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define default_arg_offset</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(offsetof(struct <a class="el" href="structseccomp__data.html">seccomp_data</a>, args[x]))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enhanced Seccomp Architecture/Machine Specific Code</p>
<p>Copyright (c) 2012,2018 Red Hat <a href="#" onclick="location.href='mai'+'lto:'+'pmo'+'or'+'e@r'+'ed'+'hat'+'.c'+'om'; return false;">pmoor<span style="display: none;">.nosp@m.</span>e@re<span style="display: none;">.nosp@m.</span>dhat.<span style="display: none;">.nosp@m.</span>com</a> Author: Paul Moore <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'l@'+'pau'+'l-'+'moo'+'re'+'.co'+'m'; return false;">paul@<span style="display: none;">.nosp@m.</span>paul<span style="display: none;">.nosp@m.</span>-moor<span style="display: none;">.nosp@m.</span>e.co<span style="display: none;">.nosp@m.</span>m</a> </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00052">52</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae3f11f18efd818fe4d492ff77734b9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f11f18efd818fe4d492ff77734b9cc">&#9670;&nbsp;</a></span>arch_arg_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00300">300</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a198eb9d70c8f7cd6a79b96503349fbdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a198eb9d70c8f7cd6a79b96503349fbdf">&#9670;&nbsp;</a></span>arch_arg_offset_hi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset_hi </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset for the high 32 bits </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the high 32 bits of the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00273">273</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a0ac598794e8dd44abe0b23106441cc28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac598794e8dd44abe0b23106441cc28">&#9670;&nbsp;</a></span>arch_arg_offset_lo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_arg_offset_lo </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the argument offset for the lower 32 bits </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">arg</td><td>the argument number</td></tr>
  </table>
  </dd>
</dl>
<p>Determine the correct offset for the low 32 bits of the given argument based on the architecture definition. Returns the offset on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00246">246</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="af18ae35357a900fe01236d72a444eb14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af18ae35357a900fe01236d72a444eb14">&#9670;&nbsp;</a></span>arch_def_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structarch__def.html">arch_def</a>* arch_def_lookup </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup the architecture definition </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>Return the matching architecture definition, returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00131">131</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="aa93d63209c3892586bee06d573e2cb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93d63209c3892586bee06d573e2cb67">&#9670;&nbsp;</a></span>arch_def_lookup_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structarch__def.html">arch_def</a>* arch_def_lookup_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>arch_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup the architecture definition by name </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch_name</td><td>the architecture name</td></tr>
  </table>
  </dd>
</dl>
<p>Return the matching architecture definition, returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00188">188</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="ab8466d6058b4e188063f954ef6741005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8466d6058b4e188063f954ef6741005">&#9670;&nbsp;</a></span>arch_filter_rule_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_filter_rule_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdb__filter.html">db_filter</a> *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structdb__api__rule__list.html">db_api_rule_list</a> *&#160;</td>
          <td class="paramname"><em>rule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new rule to the specified filter </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>the seccomp filter db </td></tr>
    <tr><td class="paramname">strict</td><td>the rule</td></tr>
  </table>
  </dd>
</dl>
<p>This function adds a new argument/comparison/value to the seccomp filter for a syscall; multiple arguments can be specified and they will be chained together (essentially AND'd together) in the filter. When the strict flag is true the function will fail if the exact rule can not be added to the filter, if the strict flag is false the function will not fail if the function needs to adjust the rule due to architecture specifics. Returns zero on success, negative values on failure.</p>
<p>It is important to note that in the case of failure the db may be corrupted, the caller must use the transaction mechanism if the db integrity is important. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00430">430</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="ae892194241477b41ee0b221d072af5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae892194241477b41ee0b221d072af5f3">&#9670;&nbsp;</a></span>arch_syscall_resolve_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_resolve_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a syscall name to a number </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">name</td><td>the syscall name</td></tr>
  </table>
  </dd>
</dl>
<p>Resolve the given syscall name to the syscall number based on the given architecture. Returns the syscall number on success, including negative pseudo syscall numbers; returns __NR_SCMP_ERROR on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00315">315</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a6f1e7662220f5dccc86b07bb71b19e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f1e7662220f5dccc86b07bb71b19e96">&#9670;&nbsp;</a></span>arch_syscall_resolve_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* arch_syscall_resolve_num </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a syscall number to a name </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">num</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Resolve the given syscall number to the syscall name based on the given architecture. Returns a pointer to the syscall name string on success, including pseudo syscall names; returns NULL on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00335">335</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a794aab2ebc0d182ef584e2844d572957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794aab2ebc0d182ef584e2844d572957">&#9670;&nbsp;</a></span>arch_syscall_rewrite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_rewrite </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>syscall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rewrite a syscall value to match the architecture </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Syscalls can vary across different architectures so this function rewrites the syscall into the correct value for the specified architecture. Returns zero on success, -EDOM if the syscall is not defined for @arch, and negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00390">390</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a1ffc4683b4a77cdd29225036b5d81241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffc4683b4a77cdd29225036b5d81241">&#9670;&nbsp;</a></span>arch_syscall_translate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_syscall_translate </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarch__def.html">arch_def</a> *&#160;</td>
          <td class="paramname"><em>arch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>syscall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate the syscall number </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture definition </td></tr>
    <tr><td class="paramname">syscall</td><td>the syscall number</td></tr>
  </table>
  </dd>
</dl>
<p>Translate the syscall number, in the context of the native architecture, to the provided architecture. Returns zero on success, negative values on failure. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00355">355</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
<a id="a579276fd8570ba70c8bc58e0095992dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a579276fd8570ba70c8bc58e0095992dd">&#9670;&nbsp;</a></span>arch_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_valid </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>arch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate the architecture token </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arch</td><td>the architecture token</td></tr>
  </table>
  </dd>
</dl>
<p>Verify the given architecture token; return zero if valid, -EINVAL if not. </p>

<p class="definition">Definition at line <a class="el" href="arch_8c_source.html#l00119">119</a> of file <a class="el" href="arch_8c_source.html">arch.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
